<div class="operations-wrapper">

  <!-- === Удалить участника === -->
  <div class="operation">
    <div class="description">
      <div class="header">
        <h3>Удалить участника</h3>
        <p>Удалить одного участника из музыкальной группы</p>
      </div>

      <form [formGroup]="removeParticipantForm">
        <div class="input-wrapper">
          <label class="label" for="band-id">ID музыкальной группы *</label>
          <input
            [class.error]="hasFieldError(removeParticipantForm, 'bandId')"
            class="input"
            formControlName="bandId"
            id="band-id"
            min="1"
            placeholder="Введите ID группы"
            type="number" />
          <div [class.show]="hasFieldError(removeParticipantForm, 'bandId')" class="error-container">
            <div class="error-message">{{ removeParticipantFieldError }}</div>
          </div>
        </div>

        <button
          (click)="onRemoveParticipant()"
          [disabled]="removeParticipantForm.invalid || isLoading()"
          class="btn btn-primary"
          type="button">
          Удалить участника
        </button>
      </form>
    </div>

    <div class="result">
      @if (removeParticipantError()) {
        <h4 class="error-message-block">{{ removeParticipantError() }}</h4>
      }
      @if (removeParticipantSuccess()) {
        <h4 class="success-message-block">{{ removeParticipantSuccess() }}</h4>
      }
      @if (removeParticipantResult()) {
        <h4>Результат удаления участника:</h4>
        <p>ID: {{ removeParticipantResult()?.id }}</p>
        <p>Название: {{ removeParticipantResult()?.name }}</p>
        <p>Участников: {{ removeParticipantResult()?.numberOfParticipants }}</p>
        <p>Жанр: {{ removeParticipantResult()?.genre }}</p>
      }
      @if (!removeParticipantError() && !removeParticipantResult() && !removeParticipantSuccess()) {
        Здесь будет результат
      }
    </div>
  </div>

  <!-- === Максимальные координаты === -->
  <div class="operation">
    <div class="description">
      <div class="header">
        <h3>Максимальные координаты</h3>
        <p>Найти группу с максимальными значениями координат</p>
      </div>

      <button
        (click)="onGetMaxCoordinates()"
        [disabled]="isLoading()"
        class="btn btn-secondary"
        type="button">
        @if (isLoading()) { <span class="loading-spinner"></span> }
        Найти группу
      </button>
    </div>

    <div class="result">
      @if (maxCoordinatesError()) {
        <h4 class="error-message-block">{{ maxCoordinatesError() }}</h4>
      }
      @if (maxCoordinatesBand()) {
        <h4>Группа с максимальными координатами:</h4>
        <p>ID: {{ maxCoordinatesBand()?.id }}</p>
        <p>Название: {{ maxCoordinatesBand()?.name }}</p>
        <p>Координата X: {{ maxCoordinatesBand()?.coordinates?.x }}</p>
        <p>Координата Y: {{ maxCoordinatesBand()?.coordinates?.y }}</p>
        <p>Дата основания: {{ formatDate(maxCoordinatesBand()?.establishmentDate || '') }}</p>
      }
      @if (!maxCoordinatesError() && !maxCoordinatesBand() && !maxCoordinatesSuccess()) {
        Здесь будет результат
      }
    </div>
  </div>

  <!-- === Группы по дате основания === -->
  <div class="operation">
    <div class="description">
      <div class="header">
        <h3>Группы по дате основания</h3>
        <p>Найти группы, основанные до указанной даты</p>
      </div>

      <form [formGroup]="establishedBeforeForm">
        <div class="input-wrapper">
          <label class="label" for="establishment-date">Дата основания *</label>
          <input
            [class.error]="hasFieldError(establishedBeforeForm, 'date')"
            class="input"
            formControlName="date"
            id="establishment-date"
            type="date" />
          <div [class.show]="hasFieldError(establishedBeforeForm, 'date')" class="error-container">
            <div class="error-message">{{ establishedBeforeFieldError }}</div>
          </div>
        </div>

        <button
          (click)="onGetEstablishedBefore()"
          [disabled]="establishedBeforeForm.invalid || isLoading()"
          class="btn"
          type="button">
          Найти группы
        </button>
      </form>
    </div>

    <div class="result">
      @if (establishedBeforeError()) {
        <h4 class="error-message-block">{{ establishedBeforeError() }}</h4>
      }
      @if (establishedBeforeBands().length > 0) {
        <h4>Группы, основанные до указанной даты ({{ establishedBeforeBands().length }}):</h4>
        @for (band of establishedBeforeBands(); track band.id) {
          <p>ID: {{ band.id }}</p>
          <p>Название: {{ band.name }}</p>
          <p>Дата основания: {{ formatDate(band.establishmentDate) }}</p>
          <p>Участников: {{ band.numberOfParticipants }}</p>
          <hr />
        }
      }
      @if (!establishedBeforeError() && establishedBeforeBands().length === 0 && !establishedBeforeSuccess()) {
        Здесь будет результат
      }
    </div>
  </div>

  <!-- === Уникальные количества альбомов === -->
  <div class="operation">
    <div class="description">
      <div class="header">
        <h3>Уникальные количества альбомов</h3>
        <p>Получить список уникальных значений количества альбомов</p>
      </div>

      <button
        (click)="onGetUniqueAlbumsCount()"
        [disabled]="isLoading()"
        class="btn btn-info"
        type="button">
        Получить данные
      </button>
    </div>

    <div class="result">
      @if (uniqueAlbumsError()) {
        <h4 class="error-message-block">{{ uniqueAlbumsError() }}</h4>
      }
      @if (uniqueAlbumsCount().length > 0) {
        <h4>Уникальные количества альбомов:</h4>
        @for (count of uniqueAlbumsCount(); track count) {
          <p>{{ count }}</p>
        }
      }
      @if (!uniqueAlbumsError() && uniqueAlbumsCount().length === 0 && !uniqueAlbumsSuccess()) {
        Здесь будет результат
      }
    </div>
  </div>

  <!-- === Создать награду Best Band Award === -->
  <div class="operation">
    <div class="description">
      <div class="header">
        <h3>Создать награду Best Band Award</h3>
        <p>Создать награду для музыкальной группы по жанру</p>
      </div>

      <form [formGroup]="createAwardForm">
        <div class="input-wrapper">
          <label class="label" for="award-band-id">ID музыкальной группы *</label>
          <input
            [class.error]="hasFieldError(createAwardForm, 'musicBandId')"
            class="input"
            formControlName="musicBandId"
            id="award-band-id"
            min="1"
            placeholder="Введите ID группы"
            type="number" />
          <div [class.show]="hasFieldError(createAwardForm, 'musicBandId')" class="error-container">
            <div class="error-message">{{ awardBandIdError }}</div>
          </div>
        </div>

        <div class="input-wrapper">
          <label class="label" for="award-genre">Жанр *</label>
          <select
            [class.error]="hasFieldError(createAwardForm, 'genre')"
            class="input"
            formControlName="genre"
            id="award-genre">
            <option value="" disabled selected>Выберите жанр</option>
            @for (option of musicGenreOptions; track option.value) {
              <option [value]="option.value">{{ option.label }}</option>
            }
          </select>
          <div [class.show]="hasFieldError(createAwardForm, 'genre')" class="error-container">
            <div class="error-message">{{ awardGenreError }}</div>
          </div>
        </div>

        <button
          (click)="onCreateBestBandAward()"
          [disabled]="createAwardForm.invalid || isLoading()"
          class="btn btn-success"
          type="button">
          Создать награду
        </button>
      </form>
    </div>

    <div class="result">
      @if (bestBandAwardError()) {
        <h4 class="error-message-block">{{ bestBandAwardError() }}</h4>
      }
      @if (bestBandAwardResult()) {
        <h4>Награда успешно создана:</h4>
        <p>ID награды: {{ bestBandAwardResult()?.id }}</p>
        <p>Группа: {{ bestBandAwardResult()?.bandName }}</p>
        <p>Жанр: {{ bestBandAwardResult()?.genre }}</p>
        <p>Дата создания: {{ formatDate(bestBandAwardResult()?.createdAt || '') }}</p>
      }
      @if (!bestBandAwardError() && !bestBandAwardResult() && !bestBandAwardSuccess()) {
        Здесь будет результат
      }
    </div>
  </div>
</div>
