<!-- music-band-form.component.html -->
<div class="wrapper">
  <div class="creation-section">
    <div class="section-header">
      <h4>{{ formTitle }}</h4>
    </div>

    <form [formGroup]="musicBandForm" class="creation-form">
      <!-- Основные поля -->
      <div class="form-row">
        <div class="form-group">
          <label class="label" for="band-name">Название *</label>
          <input
            [class.error]="hasFieldError('name')"
            class="input"
            formControlName="name"
            id="band-name"
            placeholder="Введите название группы"
            type="text">
          <div [class.show]="hasFieldError('name')" class="error-container">
            <div class="error-message">{{ getFieldError('name') }}</div>
          </div>
        </div>

        <div class="form-group">
          <label class="label" for="band-description">Описание *</label>
          <input
            [class.error]="hasFieldError('description')"
            class="input"
            formControlName="description"
            id="band-description"
            placeholder="Введите описание"
            type="text">
          <div [class.show]="hasFieldError('description')" class="error-container">
            <div class="error-message">{{ getFieldError('description') }}</div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="label" for="band-participants">Участников *</label>
          <input
            [class.error]="hasFieldError('numberOfParticipants')"
            class="input"
            formControlName="numberOfParticipants"
            id="band-participants"
            min="1"
            placeholder="Количество участников"
            type="number">
          <div [class.show]="hasFieldError('numberOfParticipants')" class="error-container">
            <div class="error-message">{{ getFieldError('numberOfParticipants') }}</div>
          </div>
        </div>

        <div class="form-group">
          <label class="label" for="band-singles">Синглов *</label>
          <input
            [class.error]="hasFieldError('singlesCount')"
            class="input"
            formControlName="singlesCount"
            id="band-singles"
            min="1"
            placeholder="Количество синглов"
            type="number">
          <div [class.show]="hasFieldError('singlesCount')" class="error-container">
            <div class="error-message">{{ getFieldError('singlesCount') }}</div>
          </div>
        </div>

        <div class="form-group">
          <label class="label" for="band-albums">Альбомов *</label>
          <input
            [class.error]="hasFieldError('albumsCount')"
            class="input"
            formControlName="albumsCount"
            id="band-albums"
            min="1"
            placeholder="Количество альбомов"
            type="number">
          <div [class.show]="hasFieldError('albumsCount')" class="error-container">
            <div class="error-message">{{ getFieldError('albumsCount') }}</div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="label" for="band-establishment">Дата основания *</label>
          <input
            [class.error]="hasFieldError('establishmentDate')"
            class="input"
            formControlName="establishmentDate"
            id="band-establishment"
            type="date">
          <div [class.show]="hasFieldError('establishmentDate')" class="error-container">
            <div class="error-message">{{ getFieldError('establishmentDate') }}</div>
          </div>
        </div>

        <div class="form-group">
          <label class="label">Жанр *</label>
          <app-custom-select
            [label]="''"
            [options]="genreOptions"
            [placeholder]="'Выберите жанр'"
            [required]="true"
            formControlName="genre">
          </app-custom-select>
          <div [class.show]="hasFieldError('genre')" class="error-container">
            <div class="error-message">{{ getFieldError('genre') }}</div>
          </div>
        </div>
      </div>

      <!-- Вложенные селекторы -->
      <div class="nested-section">
        <label class="label">Координаты *</label>
        <app-coordinates-selector
          #coordinatesSelector
          (coordinatesSelected)="onCoordinatesSelected($event)">
        </app-coordinates-selector>
        <div class="error-container" [class.show]="hasSelectorError(coordinatesId())">
          <div class="error-message">Необходимо выбрать координаты</div>
        </div>
      </div>

      <div class="nested-section">
        <label class="label">Лучший альбом *</label>
        <app-album-selector
          #albumSelector
          (albumSelected)="onAlbumSelected($event)">
        </app-album-selector>
        <div class="error-container" [class.show]="hasSelectorError(bestAlbumId())">
          <div class="error-message">Необходимо выбрать альбом</div>
        </div>
      </div>

      <div class="nested-section">
        <label class="label">Лидер *</label>
        <app-person-selector
          #personSelector
          (personSelected)="onPersonSelected($event)">
        </app-person-selector>
        <div class="error-container" [class.show]="hasSelectorError(frontManId())">
          <div class="error-message">Необходимо выбрать лидера</div>
        </div>
      </div>

      <!-- Глобальная ошибка -->
      @if (errorMessage()) {
        <div class="global-error">
          {{ errorMessage() }}
        </div>
      }

      <!-- Действия формы -->
      <div class="form-actions">
        <button
          (click)="onCancel()"
          class="btn btn-secondary"
          type="button">
          Отмена
        </button>
        <button
          (click)="onSubmit()"
          [disabled]="!isFormValid || isLoading()"
          class="btn btn-primary"
          type="button">
          {{ submitButtonText }}
        </button>
      </div>
    </form>
  </div>
</div>
